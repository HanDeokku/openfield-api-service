# 목표

토지 정보를 보여주는 rest api 제공

### 최소요구사항

- [x] 회원가입을 할 수 있다.
  - [x] 회원가입에 대한 엔드포인트를 적어주세요. (POST /users/signup/)
  - [x] 입력 데이터에 대한 유효성 검사를 한다.
  - [x] 성공 시 메시지를 반환한다.
  - [x] (필요한 경우) 성공 시 토큰 등을 반환해 바로 로그인
  - [x] 실패 시 메시지를 반환한다.
- [x] 로그인을 할 수 있다.
  - [x] 로그인에 대한 엔드포인트를 적어주세요. (POST /users/login/)
  - [x] 로그아웃에 대한 엔드포인트를 적어주세요. (POST /users/logout/)
  - [x] 성공 시 토큰, id 등을 반환한다.
  - [x] 실패 시 메시지를 반환한다.
- [x] 로그아웃을 할 수 있다.
- [x] 토지 DB를 만든다.
  - [x] 토지 model을 만든다.
- [x] 토지 리스트를 제공할 수 있다.
  - [x] 토지 리스트에 대한 엔드포인트를 적어주세요. (GET /farms/list/)
  - [x] 페이지네이션을 할 수 있다.                  GET farms/list/?page=2
  - [x] 필터링을 지원한다.                         GET /list/?farm_created=20230101
  - [x] 성공 시 json 데이터를 응답한다.
  - [ ] 로그인 토큰 여부를 확인후 접근 인가를 할 수 있다. 
- [x] 토지 상세를 제공할 수 있다.
  - [x] 토지 상세에 대한 엔드포인트를 적어주세요. (GET /farms/detail/<int:pk>/) // 이때 pk는 farm_id 입니다.
  - [x] 성공 시 json 데이터를 응답한다.
  - [X] 실패 시 메시지를 반환한다.  // 실패시 404 오류 내장 
- [x] Admin 페이지에 보여줄 수 있다.
  - [x] User를 보여줄 수 있다.
  - [x] Farm을 보여줄 수 있다. (이미지 포함)
  - [x] Farm detail을 보여줄 수 있다. (이미지 포함)
  - [x] Create Farm이 가능하다. (이미지 업로드 포함)
  - [x] Update Farm이 가능하다.
  - [x] Delete Farm이 가능하다.
- [x] Admin 페이지에서 이미지 업로드를 할 수 있다. 
  - [x] (test) 임의의 100 개 이미지를 버킷에 업로드하고 이미지 URL을 DB에 저장 할 수 있다.
  - [x] Admin 페이지에서 이미지를 업로드하면 AWS S3 버킷에 이미지 파일이 저장된다.
  - [x] AWS S3 버킷에 저장된 이미지의 URL을 DB 테이블에 저장할 수 있다.
  - [x] DB에 farm_id 와 이미지 URL을 저장하는 테이블을 새로 생성한다. 
  - [x] DB 테이블에 저장된 URL을 farm detail View 반환시 Response로 반환 가능하다. 
  - [x] (추가) DB에 저장된 이미지 URL을 삭제시 AWS S3 버킷에 저장된 이미지도 같이 삭제됨.
  - [X] AWS 접근 key 를 따로 저장하고 .gitignore 할 수 있다.
- [x] 토지 정보를 받아 DB에 저장할 수 있다.
  - [x] 토지 위치 정보와 api로 이미지를 받아오는 함수를 만든다.
  - [x] 어드민 페이지에서 여러 토지의 위치 정보가 담긴 csv를 업로드하는 버튼을 만들 수 있다.
  - [x] 업로드한 위치 정보 csv와 이미지를 DB에 저장할 수 있다.
- [x] 모델링을 수행하고 결과를 DB에 저장할 수 있다.
  - [x] 토지 이미지를 받아와 객체탐지 모델 예측을 수행할 수 있다
  - [x] 예측한 결과를 S3, DB에 저장할 수 있다.
  - [x] 기존 모델에 폴리곤을 추가했다.
  - [x] 예측한 결과와 farm 모델을 통해 폴리곤 안의 객체를 찾을 수 있다.
  - [x] 그 결과를 저장할 수 있다.
  - [x] 객체 탐지, 폴리곤 안 객체 탐지 결과를 detail view에 보여줄 수 있다.
  - [x] (Advanced) 폴리곤과 객체를 시각화할 수 있다.
- (향후) 회원에 따른 미들웨어, 모델링 등
- [x] chatbot 기능.
  - [x] 질문에 따른 답변 값을 return 한다.
  - [x] 질문에 따른 답변 값에 대한 엔드포인트를 적어주세요. (POST /chatbot/chat)
  - [x] chroma db를 사용하였다.
  - [x] chroma db에 저장되어 있는 정보와 유사도가 낮은 질문을 3회 이상 할 경우 관련 없는 질문을 한다는 return값을 반환한다.
  - [ ] SESSION CLEAR 할 수 있다
  - [x] SESSION CLEAR 엔드포인트를 적어주세요. (GET /chatbot/clear-session/)
- [x] 사용자 권한별로 view 구분 
  - [x] 토큰을 주었을때 관리자인지 사용자인지 구분할 수 있게
  - [x] 사용자 list view - 유휴 농지 중 임대 가능한 농지 
  - [x] 사용자 detail page view - 유휴농지 중 임대 가능한 농지
  - [x] 관리자 list view - 유휴 농지
  - [x] 관리자 detail page view - 유휴농지 
  - [x] 관리자 list view - 불법 건축물
  - [x] 관리자 detail page view - 불법 건축물 -> 불법 건축물 확인 필요 
  - [x] 관리자 mypage - 유휴 농지 임대 신청 리스트 
  - [x] 사용자 mypage - 그 사용자와 관련된 농지의 로그